[id="Ports_and_Firewalls_Requirements_{context}"]
= Ports and Firewalls Requirements

For the components of {Project} architecture to communicate, ensure that the required network ports are open and free on the base operating system.
You must also ensure that the required network ports are open on any network-based firewalls.

Use this information to configure any network-based firewalls.
Note that some cloud solutions must be specifically configured to allow communications between machines because they isolate machines similarly to network-based firewalls.
If you use an application-based firewall, ensure that the application-based firewall permits all applications that are listed in the tables and known to your firewall.
If possible, disable the application checking and allow open port communication based on the protocol.

.Integrated {SmartProxy}
{ProjectServer} has an integrated {SmartProxy} and any host that is directly connected to {ProjectServer} is a Client of {Project} in the context of this section.
This includes the base operating system on which {SmartProxyServer} is running.

.Clients of {SmartProxy}
Hosts which are clients of {SmartProxies}, other than {Project}'s integrated {SmartProxy}, do not need access to {ProjectServer}.
ifdef::satellite[]
For more information on {Project} Topology and an illustration of port connections, see {PlanningDocURL}sect-Documentation-Architecture_Guide-Capsule_Networking[{SmartProxy} Networking] in _Planning for {ProjectNameX}_.
endif::[]

Required ports can change based on your configuration.

ifdef::satellite[]
A matrix table of ports is available in the Red{nbsp}Hat Knowledgebase solution https://access.redhat.com/solutions/5627751[Red Hat Satellite List of Network Ports].
endif::[]

The following tables indicate the destination port and the direction of network traffic:

.{ProjectServer} incoming traffic
[cols="15%,15%,15%,15%,20%,20%",options="header"]

|====
| Destination Port | Protocol | Service |Source| Required For |Function
ifeval::["{mode}" == "connected"]
| 7 | ICMP and UDP | ECHO | {Smartproxy} |  DHCP | ICMP ECHO to verify IP address is free (Optional)
endif::[]
 .3+| 80 .3+| TCP .3+| HTTP .3+| Client | Content Host Registration | Capsule CA RPM Installation
                                        | Provisioning | Template Retrieval
                                        | Bootdisk | iPXE chained template retrieval
 .8+| 443 .8+| TCP .8+| HTTPS .8+| {Smartproxy}| {Smartproxy} Registration | (smart host, {SmartProxy})

Content Mirroring

Forward Request to {Project}

External Node Classification

Run Report

Template retrieval
                                         | Power Management | iPXE chained template retrieval
                                         | goferd message bus |Send report to {ProjectServer}

Initiation
                                         | Telemetry Data Upload | Send data to Red{nbsp}Hat Portal
                                         | OpenSCAP | Send report from {SmartProxy} to {Project}
                                         | Content promotion | Initiation
                                         | Content Sync | Initiation

ifeval::["{mode}" == "connected"]
Red{nbsp}Hat CDN
endif::[]
                                         | Remote Execution result upload |
 .3+| .3+| .3+| .3+| {Projectserver} | Content Promotion | Initiation
                                     | Content Sync | Initiation
                                     | Remote Install | Initiation
ifdef::katello,satellite[]
| 5646 | TCP | AMQP |{SmartProxy}| Power Management for Katello agent | Forward message to Qpid dispatch router on {Project
endif::[]
| 5671 | | | {ProjectServer} | Remote install for Katello agent | Send install command to client

Forward message to dispatch router on {Project}
| 5910 - 5930 | TCP | SSL/TLS | Client | Compute Resource's virtual console
|====

Any managed host that is directly connected to {ProjectServer} is a client in this context because it is a client of the integrated {SmartProxy}.
This includes the base operating system on which a {SmartProxyServer} is running.

A DHCP {SmartProxy} performs ICMP ping or TCP echo connection attempts to hosts in subnets with DHCP IPAM set to find out if an IP address considered for use is free.
This behavior can be turned off using `{foreman-installer} --foreman-proxy-dhcp-ping-free-ip=false`.

.{ProjectServer} outgoing traffic
[cols="15%,15%,15%,15%,20%,20%",options="header"]
|====
| Destination Port | Protocol | Service |Source| Required For | Function
| 22, 16514 | TCP | SSH SSH/TLS | Compute Resource | {Project} originated communications, for compute resources in libvirt |
| 53 | TCP and UDP | DNS | DNS Server | Orchestration | Validation of DNS conflicts
| 80 | TCP | HTTP | Remote repository | Content Sync | Remote yum repository
| 389, 636 | TCP | LDAP, LDAPS | External LDAP Server | LDAP | LDAP authenticatiion, necessary only if external authentication is enabled.
The port can be customized when `LDAPAuthSource` is defined
 .3+| 443 .3+| TCP .3+| HTTPS | {SmartProxy} | Content mirroring | Initiation
                              | EC2 | Compute resources | Fog interactions (query/create/destroy) |
//ifdef::satellite[]
//ifeval::["{mode}" == "connected"]
                              Red{nbsp}Hat CDN | Content Sync | Red{nbsp}Hat CDN |
                          ||| cert-api.access.redhat.com | Telemetry data upload and report |
//endif::[]
//endif::[]
| 5000 | TCP | HTTP | Compute Resource | Compute resources | Fog interactions (query/create/destroy)
 .2+| 5671 .2+|  .2+|  | Qpid |Remote install | Send install command to  client
| Dispatch router (hub) | Remote install | Forward message to dispatch router on {Project}
| 5900 - 5930 | TCP | SSL/TLS | Hypervisor | noVNC console | Launch noVNC console
 .4+| 9090 .4+| TCP .4+| HTTPS .4+| {SmartProxy} | Provisioning | {SmartProxy} API requirement to configure TFTP, DHCP and others
                                                 | Remote execution | Run job on VM
                                                 | {SmartProxy} feature retrieval |
                                                 | OpenSCAP | View SCAP report in HTML or XML format
|====
