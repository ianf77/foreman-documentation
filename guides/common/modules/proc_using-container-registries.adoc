[id="Using_Container_Registries_{context}"]
= Using Container Registries

Podman and Docker can be used to fetch content from container registries.

.Configuring Docker and Podman to trust the Certificate Authority

Podman uses two paths to locate the CA file, namely, `/etc/containers/certs.d/` and `/etc/docker/certs.d/`.

* Copy the root CA file to one of these locations, with the exact path determined by the server hostname, and naming the file `ca.crt`:

[options="nowrap", subs="+quotes,attributes"]
----
$ sudo cp rootCA.pem /etc/containers/certs.d/quay-server.example.com/ca.crt
----

* Alternatively, if you are using Docker, you can copy the root CA file to the equivalent Docker directory:

[options="nowrap", subs="+quotes,attributes"]
----
$ sudo cp rootCA.pem /etc/docker/certs.d/quay-server.example.com/ca.crt
----

You should no longer need to use the `--tls-verify=false` option when logging in to the registry:
[options="nowrap", subs="+quotes,attributes"]
----
$ sudo podman login quay-server.example.com

Username: quayadmin
Password:
Login Succeeded!
----

ifndef::orcharhino[]
.Container Registries on {SmartProxies}

On {SmartProxies} with content, the https://github.com/Katello/smart_proxy_container_gateway[Container Gateway] {SmartProxy} plugin acts as the container registry.
It caches authentication information from Katello and proxies incoming requests to Pulp.
The Container Gateway is available by default on {SmartProxies} with content.
endif::[]

.Procedure

Logging in to the container registry:
[options="nowrap", subs="+quotes,attributes"]
----
# podman login {foreman-example-com}
----

Listing container images:
[options="nowrap", subs="+quotes,attributes"]
----
# podman search {foreman-example-com}/
----

Pulling container images:
[options="nowrap", subs="+quotes,attributes"]
----
# podman pull {foreman-example-com}/my-image:<optional_tag>
----

ifdef::katello[]
.Limitations

With the Katello 4.0 release, the Container Gateway does not support pulling container images that require authentication.
Until it does, ensure that *Unauthenticated Pull* is checked for all Lifecycle Environments that have container repositories that are expected to be served by {SmartProxies}.
See also https://projects.theforeman.org/issues/32085[Foreman Issue #32085]
endif::[]
